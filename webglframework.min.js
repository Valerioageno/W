W={o:0,p:{},n:{},s:e=>{gl=a.getContext("webgl2");var r=gl.createShader(35633);gl.shaderSource(r,"#version 300 es\nin vec4 position;in vec4 color;uniform mat4 mvp;uniform mat4 model;uniform mat4 modelInverse;out vec4 v_color;out vec3 v_position;void main() {gl_Position=mvp*position;v_position=vec3(model*position);v_color=color;}"),gl.compileShader(r);var o=gl.createShader(35632);gl.shaderSource(o,"#version 300 es\nprecision mediump float;uniform vec3 light;in vec3 v_position;in vec4 v_color;out vec4 c;void main(){c=vec4(v_color.rgb*(max(dot(light,normalize(cross(dFdx(v_position),dFdy(v_position)))),0.0)+0.2), 1.0);}"),gl.compileShader(o),W.P=gl.createProgram(),gl.attachShader(W.P,r),gl.attachShader(W.P,o),gl.linkProgram(W.P),gl.useProgram(W.P),console.log("vertex shader:",gl.getShaderInfoLog(r)||"OK"),console.log("fragment shader:",gl.getShaderInfoLog(o)||"OK"),console.log("program:",gl.getProgramInfoLog(W.P)||"OK"),gl.clearColor(1,1,1,1),gl.enable(2929)},b:(e,r)=>{gl.bindBuffer(34962,gl.createBuffer()),gl.bufferData(34962,e,35044);var o=gl.getAttribLocation(W.P,r);gl.vertexAttribPointer(o,3,5126,!1,0,0),gl.enableVertexAttribArray(o)},l:e=>W.p[W.N][e]+(W.n[W.N][e]-W.p[W.N][e])*(W.n[W.N].f/W.n[W.N].t),t:e=>e.translateSelf(W.l("x"),W.l("y"),W.l("z")).rotateSelf(W.l("rx"),0,0).rotateSelf(0,W.l("ry"),0).rotateSelf(0,0,W.l("rz")).scaleSelf(W.l("w"),W.l("h"),W.l("d")),i:e=>{e.n||="o"+W.o++,e={...W.p[e.n]=W.n[e.n]||{w:1,h:1,d:1,x:0,y:0,z:0,rx:0,ry:0,rz:0,b:"777"},...e},e.t||=1,e.f=1,W.n[e.n]=e},group:e=>{e.T="g",W.i(e)},plane:e=>{e.T="q",W.i(e)},sprite:e=>{e.T="s",W.i(e)},cube:e=>{e.T="c",W.i(e)},pyramid:e=>{e.T="p",W.i(e)},move:e=>W.i(e),camera:e=>{e.n="_c",W.i(e)},light:e=>{e.n="_l",W.i(e)},d:e=>{gl.clear(16640);var r=new DOMMatrix([1/Math.tan(.5)/(a.width/a.height),0,0,0,0,1/Math.tan(.5),0,0,0,0,1001/-999,-1,0,0,2e3/-999,0]);W.N="_c",W.t(r);var o=[],n=[];for(var t in W.n){var l=W.n[t];if(l.f<l.t&&l.f++,"q"==l.T)o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],n=[0,1,2,0,2,3];else if("c"==l.T)o=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1],n=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];else if("p"==l.T){var i=3**.5;o=[-1,0,1,1,0,1,0,i,0,1,0,1,1,0,-1,0,i,0,1,0,-1,-1,0,-1,0,i,0,-1,0,-1,-1,0,1,0,i,0,-1,0,1,-1,0,-1,1,0,1,-1,0,-1,1,0,-1,1,0,1],n=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]}W.b(new Float32Array(o),"position"),gl.bindBuffer(34963,gl.createBuffer()),gl.bufferData(34963,new Uint16Array(n),35044),gl.vertexAttrib3fv(gl.getAttribLocation(W.P,"color"),[...l.b].map((e=>("0x"+e)/16))),W.N=l.n;var g=new DOMMatrix;W.t(g),gl.uniformMatrix4fv(gl.getUniformLocation(W.P,"model"),!1,g.toFloat32Array()),gl.uniformMatrix4fv(gl.getUniformLocation(W.P,"modelInverse"),!1,g.inverse().toFloat32Array()),g.preMultiplySelf(r),gl.uniformMatrix4fv(gl.getUniformLocation(W.P,"mvp"),!1,g.toFloat32Array()),W.N="_l",gl.uniform3f(gl.getUniformLocation(W.P,"light"),W.l("x"),W.l("y"),W.l("z")),gl.drawElements(4,n.length,5123,0)}}},W.s(),W.light({z:1}),W.camera({}),setInterval(W.d,16);