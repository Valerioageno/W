W={o:0,p:{},n:{},s:r=>{gl=a.getContext`webgl`;var e=gl.createShader(35633);gl.shaderSource(e,`attribute vec4 position,color,normal;uniform float mvpfactor;uniform mat4 mvp,model,modelInverse;varying vec4 v_color;varying vec3 v_normal,v_position;void main(){gl_Position=mvp*position,v_position=vec3(model*position),v_normal=vec3(normal*modelInverse),v_color=color;}`),gl.compileShader(e);var o=gl.createShader(35632);gl.shaderSource(o,`precision mediump float;uniform vec3 light;varying vec3 v_normal,v_position;varying vec4 v_color;void main(){float nDotL=max(dot(light,normalize(v_normal)),0.);vec3 diffuse=v_color.rgb*nDotL,ambient=.2*v_color.rgb;gl_FragColor=vec4(diffuse+ambient,1.);}`),gl.compileShader(o),W.P=gl.createProgram(),gl.attachShader(W.P,e),gl.attachShader(W.P,o),gl.linkProgram(W.P),gl.useProgram(W.P),gl.clearColor(1,1,1,1),gl.enable(2929)},b:(r,e)=>{gl.bindBuffer(34962,gl.createBuffer()),gl.bufferData(34962,r,35044);var o=gl.getAttribLocation(W.P,e);gl.vertexAttribPointer(o,3,5126,!1,0,0),gl.enableVertexAttribArray(o)},l:r=>W.p[W.N][r]+(W.n[W.N][r]-W.p[W.N][r])*(W.n[W.N].f/W.n[W.N].t),t:r=>r.translateSelf(W.l(`x`),W.l(`y`),W.l(`z`)).rotateSelf(W.l(`rx`),0,0).rotateSelf(0,W.l(`ry`),0).rotateSelf(0,0,W.l(`rz`)).scaleSelf(W.l(`w`),W.l(`h`),W.l(`d`)),i:r=>{r.n||=`o`+W.o++,r={...W.p[r.n]=W.n[r.n]||{w:1,h:1,d:1,x:0,y:0,z:0,rx:0,ry:0,rz:0,b:`777`},...r},r.t||=1,r.f=1,W.n[r.n]=r},group:r=>{r.T=`g`,W.i(r)},plane:r=>{r.T=`q`,W.i(r)},sprite:r=>{r.T=`s`,W.i(r)},cube:r=>{r.T=`c`,W.i(r)},pyramid:r=>{r.T=`p`,W.i(r)},move:r=>W.i(r),camera:r=>{r.n=`_c`,W.i(r)},light:r=>{r.n=`_l`,W.i(r)},d:r=>{gl.clear(16640);var e=new DOMMatrix([1/Math.tan(.5)/(a.width/a.height),0,0,0,0,1/Math.tan(.5),0,0,0,0,1001/-999,-1,0,0,2e3/-999,0]);W.N=`_c`,W.t(e);var o=[],n=[],l=[];for(var t in W.n){var i=W.n[t];if(i.f<i.t&&i.f++,`q`==i.T)o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],n=[0,0,1,0,0,1,0,0,1,0,0,1],l=[0,1,2,0,2,3];else if(`c`==i.T)o=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1],n=[0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1],l=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];else if(`p`==i.T){var g=3**.5;o=[-1,0,1,1,0,1,0,g,0,1,0,1,1,0,-1,0,g,0,1,0,-1,-1,0,-1,0,g,0,-1,0,-1,-1,0,1,0,g,0,-1,0,1,-1,0,-1,1,0,1,-1,0,-1,1,0,-1,1,0,1],n=[0,-1,g,0,-1,g,0,-1,g,g,-1,0,g,-1,0,g,-1,0,0,-1,-g,0,-1,-g,0,-1,-g,-g,-1,0,-g,-1,0,-g,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]}W.b(new Float32Array(o),`position`),W.b(new Float32Array(n),`normal`),gl.bindBuffer(34963,gl.createBuffer()),gl.bufferData(34963,new Uint16Array(l),35044),gl.vertexAttrib3fv(gl.getAttribLocation(W.P,`color`),[...i.b].map((r=>(`0x`+r)/16))),W.N=i.n;var v=new DOMMatrix;W.t(v),gl.uniformMatrix4fv(gl.getUniformLocation(W.P,`model`),!1,v.toFloat32Array()),gl.uniformMatrix4fv(gl.getUniformLocation(W.P,`modelInverse`),!1,v.inverse().toFloat32Array()),v.preMultiplySelf(e),gl.uniformMatrix4fv(gl.getUniformLocation(W.P,`mvp`),!1,v.toFloat32Array()),W.N=`_l`,gl.uniform3f(gl.getUniformLocation(W.P,`light`),W.l(`x`),W.l(`y`),W.l(`z`)),gl.drawElements(4,l.length,5123,0)}}},W.s(),W.light({z:1}),W.camera({}),setInterval(W.d,16);