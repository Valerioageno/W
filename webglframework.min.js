W={o:0,p:{},n:{},s:o=>{gl=a.getContext("webgl2"),W.P=gl.createProgram(),gl.shaderSource(o=gl.createShader(35633),"#version 300 es\n in vec4 position;in vec4 color;uniform mat4 pv;uniform mat4 eye;uniform mat4 m;uniform vec3 billboard;out vec4 v_color;out vec3 v_position;void main(){if(billboard.z>0.){gl_Position=pv*(m[3]+eye*(position*vec4(billboard,0)));}else{gl_Position=pv*m*position;}v_position=vec3(m*position);v_color=color;}"),gl.compileShader(o),gl.attachShader(W.P,o),gl.shaderSource(o=gl.createShader(35632),"#version 300 es\nprecision mediump float;uniform vec3 light;in vec3 v_position;in vec4 v_color;out vec4 c;void main(){c=vec4(v_color.rgb*(max(dot(light,normalize(cross(dFdx(v_position),dFdy(v_position)))),0.)+.2),1);}"),gl.compileShader(o),gl.attachShader(W.P,o),gl.linkProgram(W.P),gl.useProgram(W.P),gl.clearColor(1,1,1,1),gl.enable(2929)},l:o=>W.p[W.N][o]+(W.n[W.N][o]-W.p[W.N][o])*(W.n[W.N].f/W.n[W.N].t),t:o=>o.translateSelf(W.l("x"),W.l("y"),W.l("z")).rotateSelf(W.l("rx"),0,0).rotateSelf(0,W.l("ry"),0).rotateSelf(0,0,W.l("rz")).scaleSelf(W.l("w"),W.l("h"),W.l("d")),i:o=>{o.n||="o"+W.o++,o={...W.p[o.n]=W.n[o.n]||{w:1,h:1,d:1,x:0,y:0,z:0,rx:0,ry:0,rz:0,b:"777"},...o},o.t||=1,o.f=1,W.n[o.n]=o},group:o=>{o.T="g",W.i(o)},plane:o=>{o.T="q",W.i(o)},billboard:o=>{o.T="b",W.i(o)},cube:o=>{o.T="c",W.i(o)},pyramid:o=>{o.T="p",W.i(o)},move:o=>W.i(o),camera:o=>{o.n="C",W.i(o)},light:o=>{o.n="L",W.i(o)},d:(o,n,e,r,t,l)=>{for(r in gl.clear(16640),o=new DOMMatrix([1/Math.tan(.5)/(a.width/a.height),0,0,0,0,1/Math.tan(.5),0,0,0,0,901/-899,-1,0,0,1800/-899,0]),n=new DOMMatrix,W.N="C",W.t(o),W.t(n),gl.uniformMatrix4fv(gl.getUniformLocation(W.P,"pv"),!1,o.toFloat32Array()),gl.uniformMatrix4fv(gl.getUniformLocation(W.P,"eye"),!1,n.invertSelf().toFloat32Array()),l=[],W.n){(t=W.n[r]).f<t.t&&t.f++,"q"==t.T?l=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0]:"c"==t.T?l=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,-1,-1,-1,1,-1,1,1,-1]:"p"==t.T&&(l=[-1,0,1,1,0,1,0,3**.5,0,1,0,1,1,0,-1,0,3**.5,0,1,0,-1,-1,0,-1,0,3**.5,0,-1,0,-1,-1,0,1,0,3**.5,0,-1,0,1,-1,0,-1,1,0,1,-1,0,-1,1,0,-1,1,0,1]),gl.bindBuffer(34962,gl.createBuffer()),gl.bufferData(34962,new Float32Array(l),35044),gl.enableVertexAttribArray(gl.vertexAttribPointer(gl.getAttribLocation(W.P,"position"),3,5126,!1,0,0)),gl.vertexAttrib3fv(gl.getAttribLocation(W.P,"color"),[...t.b].map((o=>("0x"+o)/16))),W.N=t.n;e=new DOMMatrix;W.t(e),gl.uniformMatrix4fv(gl.getUniformLocation(W.P,"m"),!1,e.toFloat32Array()),W.N="L",gl.uniform3f(gl.getUniformLocation(W.P,"light"),W.l("x"),W.l("y"),W.l("z")),gl.uniform3f(gl.getUniformLocation(W.P,"billboard"),t.w,t.h,"b"==t.T),gl.drawArrays(4,0,l.length/3)}}},W.s(),W.light({z:1}),W.camera({}),setInterval(W.d,16)